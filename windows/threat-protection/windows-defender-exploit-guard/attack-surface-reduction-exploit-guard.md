---
title: Use Windows Defender Exploit Guard to protect your corporate network
description: Windows Defender Exploit Guard consists of features that can protect your network from malware and threat infection. It replaces EMET.
keywords: emet, exploit guard, Controlled Folder Access, Network Protection, Exploit Protection, Attack Surface Reduction, hips, host intrusion prevention system
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: w10
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
localizationpriority: medium
author: iaanw
ms.author: iawilt
---


# Reduce the attack surface with Windows Defender Exploit Guard 


**Applies to:**

- Windows 10 Insider Preview, build 16232 and later

**Audience**

- Enterprise security administrators


**Manageability available with**

- Group Policy
- PowerShell
- Windows Management Instrumentation (WMI)
- Microsoft Intune
- Windows Defender Security Center app


<into>

## Requirements

The following requirements must be met before Attack Surface Reduction will work:

Windows 10 version | Windows Defender Antivirus
Insider Preview build 16232 or later (dated July 1, 2017 or later) | [Windows Defender AV real-time protection](../windows-defender-antivirus/configure-real-time-protection-windows-defender-antivirus.md) and [cloud-delivered protection](../windows-defender-antivirus/enable-cloud-protection-windows-defender-antivirus.md) must be enabled



## Enable Attack Surface Reduction rules

You can use Group Policy to configure the state or mode for each rule. This can be useful if you only want to enable some rules, or you want to enable rules individually in audit mode.

For further details on how audit mode works, and when you might want to use it, see the [auditing Windows Defender Exploit Guard topic](audit-windows-defender-exploit-guard.md).

1.  On your Group Policy management machine, open the [Group Policy Management Console](https://technet.microsoft.com/library/cc731212.aspx), right-click the Group Policy Object you want to configure and click **Edit**.

3.  In the **Group Policy Management Editor** go to **Computer configuration**.

4.  Click **Policies** then **Administrative templates**.

5.  Expand the tree to **Windows components > Windows Defender Antivirus > Windows Defender Exploit Guard > Attack Surface Reduction**.

6. Double-click the **Configure Attack Surface Reduction rules** setting and set the option to **Enabled**. You can then set the individual state for each rule in the options section:
    - Click **Show...** and enter the Rule ID in the **Value name** column and your desired state in the **Value** column as follows:
        -  Block mode = 1
        -  Disabled = 0
        -  Audit mode = 2


        ![](images/asr-rules-gp.png)

>[!NOTE]
>Rule IDs willl be populated on machines that are enrolled in an E5 license. These machines will also properly report their Attack Surface Reduction rule history in the Windows Defender Security Center web console.


>[!NOTE]
>The tool reveals the RuleIDs. How will the IDs be hidden/how will the experience differ without an E5?



## Exclude files and folders

You can exclude files and folders from being evaluated by Attack Surface Reduction rules. You can specify individual files or folders (using folder paths or fully qualified resource names) but you cannot specify if the files should be excluded from individual rules: the exclusions will apply to all rules that are enabled (or placed in audit mode).


1.  On your Group Policy management machine, open the [Group Policy Management Console](https://technet.microsoft.com/library/cc731212.aspx), right-click the Group Policy Object you want to configure and click **Edit**.

3.  In the **Group Policy Management Editor** go to **Computer configuration**.

4.  Click **Policies** then **Administrative templates**.

5.  Expand the tree to **Windows components > Windows Defender Antivirus > Windows Defender Exploit Guard > Attack Surface Reduction**.

6. Double-click the **Exclude files and paths from Attack Surface Reduction Rules** setting and set the option to **Enabled**. Click **Show** and enter each file or folder in the **Value name** column. Enter **0** in the **Value** column for each item. 




## Review Attack Surface Reduction events in Windows Event Viewer

You can also review the Windows event log to see the events there were created when using the tool:

1. Type **Event viewer** in the Start menu to open the Windows Event Viewer.

2. On the left panel, under **Actions**, click **Import custom view...**

3. Navigate to the Exploit Guard Evaluation Package, and select the file *asr-events.xml*. Alternatively, [download the XML directly](scripts/asr-events.xml).

4. Click **OK**.

5. This will create a custom view that filters to only show the following events related to Attack Surface Reduction:

 Event ID | Description
-|-
5007 | Event when settings are changed
1122 | Event when rule fires in Audit-mode 
1121 | Event when rule fires in Block-mode 




## MDM policy settings for Controlled Folder Access 

./Vendor/MSFT/Policy/Config/Defender/EnableGuardMyFolders

## Audit/block modes

Controlled Folder Access has mitigations that can be individually enabled in audit or blocking mode. 

Component  |Description |Rule/mitigation description |
-|-|-|-
Controlled Folder Access |Automatically blocks access to content to protected folders. - This can be enabled in audit/block mode |Protected folders |Folders that are shielded by this component.
| | | Allowed apps |Apps that are allowed to write into protected folders








































### Audit/block modes

Each of these components can individually be enabled in audit or blocking mode. 

Attack Surface Reduction and Controlled Folder Access also have mitigations that can be individually enabled in audit or blocking mode. 

Component  |Description |Rule/mitigation description |
-|-|-|-
Attack Surface Reduction (ASR) | Provides rules that allow you to prevent macro, script and email threats. - Each rule can be enabled in audit/block mode - Supports file/folder exclusions applied to all rules |Rules to prevent macro threats |Block office application from creating executable content
| | | | Block obfuscated js/vbs/ps/macro code
| | | | Block office application from launching child processes
| | | | Block office application from injecting into other processes
| | | | Block Win32 imports from macro code in Office
| | | Rules to prevent script threats |Block js/vbs from executing payload downloaded from Internet
| | | | Block obfuscated js/vbs/ps/macro code
| | | Rules to prevent email threats |Block execution of executable content (exe, dll, ps, js, vbs, etc) dropped from email (webmail/mail-client).


## Policy settings for Windows Defender EG

The MDM policy settings for Windows Defender EG are listed in this section, along with example settings. 


### Attack Surface Reduction 

- ./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionOnlyExclusions
- ./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules  
-- Value as String Data Type : {75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84}:1 
  

#### Rule-GUIDs for ASR

Rule description | GUIDs 
-|-
Office rules | 
Block office application from injecting into other processes | {75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84}
 | OMA URI : “./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules”
 | Value as String Data Type : {75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84}:1 
 | 1 = Block, 2 = Audit, 0 = Disabled.
Block office application/macros from creating executable content  | {3b576869-a4ec-4529-8536-b80a7769e899}
 | Replace the above GUID with the corresponding Rule GUID
Block office application from launching child processes | {d4f940ab-401b-4efc-aadc-ad5f3c50688a}
 | Replace the above GUID with the corresponding Rule GUID
Block Win32 imports from Macro code in Office | {92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B}
  | Replace the above GUID with the corresponding Rule GUID
Block obfuscated js/vbs/ps/macro code  | {5beb7efe-fd9a-4556-801d-275e5ffc04cc}
 | Replace the above GUID with the corresponding Rule GUID
Script rules | 
Block obfuscated js/vbs/ps/macro code  | {5beb7efe-fd9a-4556-801d-275e5ffc04cc}
 | Replace the above GUID with the corresponding Rule GUID [Note: same rule as above, but also covers scripts hence written here]
Block js/vbs from executing payload downloaded from Internet. | {d3e037e1-3eb8-44c8-a917-57927947596d}
 | Replace the above GUID with the corresponding Rule GUID
Email rule | 
Block execution of executable content (exe, dll, ps, js, vbs, etc) dropped from email (webmail/mail-client). | be9ba2d9-53ea-4cdc-84e5-9b1eeee46550
 | Replace the above GUID with the corresponding Rule GUID [Currently working for Mail-client (Outlook). Personal Webmail (Outlook.com, Gmail, Yahoo) work in progress]



  

### Manually enabling the Attack Surface Reduction rules

You can also manually use GP or MDM-URIs to enable the ASR rules:

From the rules tables above, choose the ASR rules that you want to enable and set the following policy. For each rule select the right GUID.

After you’ve chosen your rules, use one of the tools above to simulate a rule to fire.
- “./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules”
- Value as String Data Type: {75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84}:2
 

### View event logs

Note: event logs are not the primary mechanism for investigation. The Windows Defender ATP portal receives much richer information that allows for investigation. Information is also presented in an interactive machine-timeline view.


#### Event fields
- **ID**: matches with the Rule-ID that triggered the block/audit.
- **Detection time**: Time of detection
- **Process Name**: The process that performed the “operation” that was blocked/audited
- **Description**: 

Windows Defender Antivirus has audited an operation that is not allowed by your IT administrator.

For more information please contact your IT administrator.
-- ID: D4F940AB-401B-4EFC-AADC-AD5F3C50688A
-- Detection time: 2017-06-21T11:52:29.062Z
-- User: SYSTEM
-- Path: C:\Windows\System32\notepad.exe
-- Process Name: C:\Program Files\Microsoft Office\Office16\winword.exe
-- Signature Version: 1.245.730.0
-- Engine Version: 1.1.13902.0
-- Product Version: 4.12.16228.1000


### View the alert notification

If you configure the test to block, a notification will be displayed from the Action Center.  This notification is customizable with your organization and contact information.
 

## Customize the notification

Customizing the Windows Defender Security Center is a simple task that provides users with a clear way to contact support.
Simply navigate in Group Policy to **Computer Configuration\Administrative Templates\Windows Components\Windows Defender Security Center\Enterprise Customization**. From there, you will be able to enable your custom notification, set your organization name and contact information.


