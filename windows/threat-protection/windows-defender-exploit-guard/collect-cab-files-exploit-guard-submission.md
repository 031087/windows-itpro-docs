---
title: Submit cab files related to Windows Defender EG problems
description: Use the command-line tool to obtain .cab file that can be used to investigate ASR rule issues.
keywords: troubleshoot, error, fix, asr, windows defender eg, exploit guard, attack surface reduction
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: w10
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
ms.localizationpriority: medium
author: iaanw
ms.author: iawilt
ms.date: 11/01/2017
---

# Collect diagnostic data for Windows Defender Exploit Guard file submissions

**Applies to:**

- Windows 10, version 1709

**Audience**

- IT administrators

This topic describes how to collect diagnostic data that can be used by Microsoft support and engineering teams to help troubleshoot issues you may encounter when using Windows Defender Exploit Guard. 

In particular, you will be asked to collect and attach this data when using the [Windows Defender Security Intelligence web-based submission form](#) if you indicate that you have encountered a problem with [Attack surface reduction rules](attack-surface-reduction-exploit-guard.md).

Before attempting this process, ensure you have read the [Troubleshoot Windows Defender Exploit Guard ASR rules](troubleshoot-asr.md) topic, met all required pre-requisites, and taken any other suggested troubleshooting steps.


1. On the endpoint where the rule is not functioning, obtain the .cab diagnostic file by following this process:

    1. Open an administrator-level version of the command prompt:
        
        1. Open the **Start** menu.
        
        2. Type **cmd**. Right-click on **Command Prompt** and click **Run as administrator**.
        
        3. Enter administrator credentials or approve the prompt.
        
    2. Navigate to the Windows Defender directory. By default, this is C:\Program Files\Windows Defender, as in the following example:
        
        ```Dos
        cd c:\program files\windows\defender
        ```
    
    3. Enter the following command and press **Enter**
        
        ```Dos
        mpcmdrun -getfiles
        ```
    
    4. A .cab file will be generated that contains various diagnostic logs. The location of the file will be specified in the output in the command prompt, but by default it will be in C:\ProgramData\Microsoft\Windows Defender\Support\MpSupportFiles.cab.

2. Attach this .cab file to the submission form where indicated.




## Related topics

## Related topics

- [Troubleshoot Attack surface reduction rules](#troubleshoot-asr.md)
- [Windows Defender Exploit Guard](windows-defender-exploit-guard.md)
- [Attack surface reduction](attack-surface-reduction-exploit-guard.md)

