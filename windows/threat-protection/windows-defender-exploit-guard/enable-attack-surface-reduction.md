---
title: Use Windows Defender Exploit Guard to protect your corporate network
description: Windows Defender Exploit Guard consists of features that can protect your network from malware and threat infection. It replaces EMET.
keywords: emet, exploit guard, Controlled Folder Access, Network Protection, Exploit Protection, Attack Surface Reduction, hips, host intrusion prevention system
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: w10
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
localizationpriority: medium
author: iaanw
ms.author: iawilt
---


# Enable Attack Surface Reduction 


**Applies to:**

- Windows 10 Insider Preview, build 16232 and later

**Audience**

- Enterprise security administrators


**Manageability available with**

- Group Policy
- PowerShell
- Windows Management Instrumentation (WMI)
- Microsoft Intune
- Windows Defender Security Center app



Attack Surface Reduction is a feature that is part of Windows Defender Exploit Guard. It helps prevent actions and apps that are typically used by exploit-seeking malware to infect machines. 

## Individually enable Attack Surface Reduction rules

You can use Group Policy to configure the state or mode for each rule. This can be useful if you only want to enable some rules, or you want to enable rules individually in audit mode.

For further details on how audit mode works, and when you might want to use it, see the [auditing Windows Defender Exploit Guard topic](audit-windows-defender-exploit-guard.md).

1.  On your Group Policy management machine, open the [Group Policy Management Console](https://technet.microsoft.com/library/cc731212.aspx), right-click the Group Policy Object you want to configure and click **Edit**.

3.  In the **Group Policy Management Editor** go to **Computer configuration**.

4.  Click **Policies** then **Administrative templates**.

5.  Expand the tree to **Windows components > Windows Defender Antivirus > Windows Defender Exploit Guard > Attack Surface Reduction**.

6. Double-click the **Configure Attack Surface Reduction rules** setting and set the option to **Enabled**. You can then set the individual state for each rule in the options section:
    - Click **Show...** and enter the Rule ID in the **Value name** column and your desired state in the **Value** column as follows:
        -  Block mode = 1
        -  Disabled = 0
        -  Audit mode = 2


        ![](images/asr-rules-gp.png)

>[!NOTE]
>Rule IDs willl be populated on machines that are enrolled in an E5 license. These machines will also properly report their Attack Surface Reduction rule history in the Windows Defender Security Center web console.


>[!NOTE]
>The tool reveals the RuleIDs. How will the IDs be hidden/how will the experience differ without an E5?






## Policy settings for Windows Defender EG

The MDM policy settings for Windows Defender EG are listed in this section, along with example settings. 


### Attack Surface Reduction 

- ./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionOnlyExclusions
- ./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules  
-- Value as String Data Type : {75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84}:1 
  

#### Rule-GUIDs for ASR

Rule description | GUIDs 
-|-
Office rules | 
Block office application from injecting into other processes | {75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84}
 | OMA URI : “./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules”
 | Value as String Data Type : {75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84}:1 
 | 1 = Block, 2 = Audit, 0 = Disabled.
Block office application/macros from creating executable content  | {3b576869-a4ec-4529-8536-b80a7769e899}
 | Replace the above GUID with the corresponding Rule GUID
Block office application from launching child processes | {d4f940ab-401b-4efc-aadc-ad5f3c50688a}
 | Replace the above GUID with the corresponding Rule GUID
Block Win32 imports from Macro code in Office | {92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B}
  | Replace the above GUID with the corresponding Rule GUID
Block obfuscated js/vbs/ps/macro code  | {5beb7efe-fd9a-4556-801d-275e5ffc04cc}
 | Replace the above GUID with the corresponding Rule GUID
Script rules | 
Block obfuscated js/vbs/ps/macro code  | {5beb7efe-fd9a-4556-801d-275e5ffc04cc}
 | Replace the above GUID with the corresponding Rule GUID [Note: same rule as above, but also covers scripts hence written here]
Block js/vbs from executing payload downloaded from Internet. | {d3e037e1-3eb8-44c8-a917-57927947596d}
 | Replace the above GUID with the corresponding Rule GUID
Email rule | 
Block execution of executable content (exe, dll, ps, js, vbs, etc) dropped from email (webmail/mail-client). | be9ba2d9-53ea-4cdc-84e5-9b1eeee46550
 | Replace the above GUID with the corresponding Rule GUID [Currently working for Mail-client (Outlook). Personal Webmail (Outlook.com, Gmail, Yahoo) work in progress]



  

### Manually enabling the Attack Surface Reduction rules

You can also manually use GP or MDM-URIs to enable the ASR rules:

From the rules tables above, choose the ASR rules that you want to enable and set the following policy. For each rule select the right GUID.

After you’ve chosen your rules, use one of the tools above to simulate a rule to fire.
- “./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionRules”
- Value as String Data Type: {75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84}:2
 

## Related topics

- [Reduce attack surfaces with Windows Defender Exploit Guard](attack-surface-reduction-exploit-guard.md)
- [Customize Attack Surface Reduction](customize-attack-surface-reduction.md)
- [Evaluate Windows Defender Exploit Guard](evaluate-windows-defender-exploit-guard.md)
